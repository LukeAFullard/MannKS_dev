============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0 -- /home/jules/.pyenv/versions/3.12.12/bin/python3.12
cachedir: .pytest_cache
rootdir: /app
configfile: pyproject.toml
collecting ... collected 68 items

tests/test_scaling.py::test_slope_scaling_datetime PASSED                [  1%]
tests/test_scaling.py::test_slope_scaling_numeric_warning PASSED         [  2%]
tests/test_scaling.py::test_invalid_scaling_unit PASSED                  [  4%]
tests/test_scaling.py::test_seasonal_slope_scaling PASSED                [  5%]
tests/test_scaling.py::test_seasonal_scaling_variations PASSED           [  7%]
tests/test_seasonal_large_dataset.py::test_seasonal_large_dataset_stratification PASSED [  8%]
tests/test_seasonal_large_dataset.py::test_seasonal_large_dataset_no_stratification_needed PASSED [ 10%]
tests/test_seasonality_and_plotting.py::test_check_seasonality_detects_seasonality PASSED [ 11%]
tests/test_seasonality_and_plotting.py::test_check_seasonality_rejects_non_seasonal PASSED [ 13%]
tests/test_seasonality_and_plotting.py::test_plot_seasonal_distribution PASSED [ 14%]
tests/test_seasonality_and_plotting.py::test_trend_plotting PASSED       [ 16%]
tests/test_seasonality_and_plotting.py::test_biweekly_seasonality PASSED [ 17%]
tests/test_seasonality_and_plotting.py::test_biweekly_seasonality_53_week_year PASSED [ 19%]
tests/test_seasonality_and_plotting.py::test_day_of_year_seasonality_leap_year PASSED [ 20%]
tests/test_seasonality_and_plotting.py::test_week_of_year_seasonality_53_week_year PASSED [ 22%]
tests/test_seasonality_and_plotting.py::test_general_season_types[year-1-YE-20] PASSED [ 23%]
tests/test_seasonality_and_plotting.py::test_general_season_types[month-12-ME-60] PASSED [ 25%]
tests/test_seasonality_and_plotting.py::test_general_season_types[day_of_week-7-D-730] PASSED [ 26%]
tests/test_seasonality_and_plotting.py::test_general_season_types[quarter-4-QE-40] PASSED [ 27%]
tests/test_seasonality_and_plotting.py::test_general_season_types[hour-24-h-336] PASSED [ 29%]
tests/test_seasonality_and_plotting.py::test_general_season_types[biweekly-26-W-208] PASSED [ 30%]
tests/test_seasonality_and_plotting.py::test_general_season_types[minute-60-min-2880] PASSED [ 32%]
tests/test_seasonality_and_plotting.py::test_general_season_types[second-60-s-7200] PASSED [ 33%]
tests/test_seasonality_and_plotting.py::test_seasonal_trend_test_aggregation_methods PASSED [ 35%]
tests/test_seasonality_and_plotting.py::test_check_seasonality_insufficient_data PASSED [ 36%]
tests/test_seasonality_and_plotting.py::test_plot_seasonal_distribution_insufficient_data PASSED [ 38%]
tests/test_seasonality_and_plotting.py::test_check_seasonality_insufficient_unique_values PASSED [ 39%]
tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season PASSED [ 41%]
tests/test_seasonality_and_plotting.py::test_check_seasonality_aggregation PASSED [ 42%]
tests/test_segmented.py::test_result_type PASSED                         [ 44%]
tests/test_segmented.py::test_segmented_trend_basic PASSED               [ 45%]
tests/test_segmented.py::test_segmented_trend_breakpoint PASSED          [ 47%]
tests/test_segmented.py::test_bagging_integration PASSED                 [ 48%]
tests/test_segmented.py::test_bagging_with_dataframe_input PASSED        [ 50%]
tests/test_segmented.py::test_insufficient_data PASSED                   [ 51%]
tests/test_segmented.py::test_dataframe_input PASSED                     [ 52%]
tests/test_segmented.py::test_no_bagging_if_n_zero PASSED                [ 54%]
tests/test_segmented.py::test_datetime_support PASSED                    [ 55%]
tests/test_segmented.py::test_slope_scaling PASSED                       [ 57%]
tests/test_segmented.py::test_hicensor_logic PASSED                      [ 58%]
tests/test_segmented.py::test_criterion_parameter PASSED                 [ 60%]
tests/test_segmented.py::test_dataframe_missing_value_column PASSED      [ 61%]
tests/test_segmented.py::test_predict_method PASSED                      [ 63%]
tests/test_segmented.py::test_predict_with_scaling PASSED                [ 64%]
tests/test_segmented.py::test_predict_with_breakpoints PASSED            [ 66%]
tests/test_segmented.py::test_breakpoint_probability PASSED              [ 67%]
tests/test_segmented.py::test_breakpoint_cis_format PASSED               [ 69%]
tests/test_segmented.py::test_bagging_zero_breakpoints PASSED            [ 70%]
tests/test_stats.py::test_confidence_intervals_lwp_method PASSED         [ 72%]
tests/test_stats.py::test_sens_estimator_censored_ambiguity_logic PASSED [ 73%]
tests/test_stats_coverage.py::test_zero_variance_handling PASSED         [ 75%]
tests/test_surrogate.py::test_iaaft_null_case PASSED                     [ 76%]
tests/test_surrogate.py::test_iaaft_trend_case PASSED                    [ 77%]
tests/test_surrogate.py::test_lomb_scargle_null_irregular PASSED         [ 79%]
tests/test_surrogate.py::test_lomb_scargle_trend_irregular PASSED        [ 80%]
tests/test_surrogate.py::test_auto_selection PASSED                      [ 82%]
tests/test_surrogate.py::test_advanced_params PASSED                     [ 83%]
tests/test_surrogate.py::test_trend_test_integration PASSED              [ 85%]
tests/test_surrogate.py::test_trend_test_integration_advanced PASSED     [ 86%]
tests/test_surrogate.py::test_iterative_ls PASSED                        [ 88%]
tests/test_surrogate.py::test_surrogate_kwargs_slicing PASSED            [ 89%]
tests/test_surrogate.py::test_censored_surrogate_propagation PASSED      [ 91%]
tests/test_surrogate.py::test_surrogate_kwargs_slicing_with_dataframe_and_nans PASSED [ 92%]
tests/test_surrogate.py::test_surrogate_imputation_logic_consistency PASSED [ 94%]
tests/test_surrogate.py::test_seasonal_trend_test_surrogate PASSED       [ 95%]
tests/test_surrogate.py::test_seasonal_trend_test_block_bootstrap PASSED [ 97%]
tests/test_surrogate.py::test_large_dataset_performance_warning PASSED   [ 98%]
tests/test_surrogate.py::test_seasonal_surrogate_kwargs_alignment PASSED [100%]

=============================== warnings summary ===============================
tests/test_seasonality_and_plotting.py::test_general_season_types[second-60-s-7200]
  /app/MannKS/seasonal_trend_test.py:1055: UserWarning: Large dataset (n=7200): Using fast approximations. Set large_dataset_mode='full' to force exact calculations.
    warnings.warn(w_str, UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_insufficient_data
  /app/MannKS/check_seasonality.py:133: UserWarning: Season '1' has less than 3 samples and will be skipped.
    warnings.warn(f"Season '{s}' has less than 3 samples and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_insufficient_data
  /app/MannKS/check_seasonality.py:133: UserWarning: Season '2' has less than 3 samples and will be skipped.
    warnings.warn(f"Season '{s}' has less than 3 samples and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_insufficient_data
  /app/MannKS/check_seasonality.py:133: UserWarning: Season '3' has less than 3 samples and will be skipped.
    warnings.warn(f"Season '{s}' has less than 3 samples and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '2' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '3' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '4' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '5' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '6' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '7' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '8' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '9' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '10' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '11' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_seasonality_and_plotting.py::test_check_seasonality_only_one_valid_season
  /app/MannKS/check_seasonality.py:135: UserWarning: Season '12' has less than 2 unique values and will be skipped.
    warnings.warn(f"Season '{s}' has less than 2 unique values and will be skipped.", UserWarning)

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=1.30e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 3 (rel_change=1.40e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=1.16e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=1.05e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 3 (rel_change=1.64e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 3 (rel_change=1.13e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=1.16e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=1.74e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=1.83e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 3 (rel_change=1.53e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_null_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 3 (rel_change=1.06e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=1.15e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=1.15e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 3 (rel_change=1.66e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 7 (rel_change=1.30e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=1.57e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 2 (rel_change=2.32e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 6 (rel_change=1.31e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 8 (rel_change=3.06e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=1.37e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=2.29e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=2.00e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=1.73e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=1.14e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=2.31e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=2.31e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=1.06e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 5 (rel_change=1.03e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_iaaft_trend_case
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 6 (rel_change=1.03e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_auto_selection
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=2.79e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_auto_selection
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 3 (rel_change=1.96e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_auto_selection
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=3.41e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_auto_selection
  /app/MannKS/_surrogate.py:113: UserWarning: IAAFT convergence stalled at iter 3 (rel_change=6.55e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(

tests/test_surrogate.py::test_trend_test_integration
  /app/MannKS/trend_test.py:790: UserWarning: IAAFT convergence stalled at iter 4 (rel_change=1.11e-03). This often indicates data with unusual spectral properties or too few observations. The result may be suboptimal but is usually acceptable.
    warnings.warn(w_str, UserWarning)

tests/test_surrogate.py::test_censored_surrogate_propagation
tests/test_surrogate.py::test_surrogate_imputation_logic_consistency
  /app/MannKS/_surrogate.py:402: UserWarning: Censored data detected in surrogate test. Surrogate series are generated using imputed values (lt_mult=0.5, gt_mult=1.1). Censoring flags are propagated to the surrogates to ensure a consistent S-statistic distribution.
    warnings.warn(

tests/test_surrogate.py::test_censored_surrogate_propagation
  /app/MannKS/_surrogate.py:506: UserWarning: Imputation with lt_mult=0.5 changes the Mann-Kendall S statistic (Raw: 1.0, Imputed: 3.0). The p-value is calculated using the Raw S statistic against surrogates derived from the Imputed data. This may lead to conservative results if imputation resolves ambiguities present in the raw data.
    warnings.warn(

tests/test_surrogate.py::test_surrogate_imputation_logic_consistency
  /app/MannKS/_surrogate.py:506: UserWarning: Imputation with lt_mult=0.5 changes the Mann-Kendall S statistic (Raw: 6.0, Imputed: 4.0). The p-value is calculated using the Raw S statistic against surrogates derived from the Imputed data. This may lead to conservative results if imputation resolves ambiguities present in the raw data.
    warnings.warn(

tests/test_surrogate.py::test_large_dataset_performance_warning
  /app/MannKS/trend_test.py:790: UserWarning: Large dataset (n=6000): Using fast approximations. Set large_dataset_mode='full' to force exact calculations.
    warnings.warn(w_str, UserWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================= 68 passed, 54 warnings in 119.58s (0:01:59) ==================
