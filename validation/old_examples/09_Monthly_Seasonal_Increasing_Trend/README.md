# Validation Case V-09: Monthly Seasonal Increasing Trend

## Objective
This validation case verifies that the `seasonal_trend_test` function correctly identifies a statistically significant, positive trend in a monthly seasonal, uncensored dataset. It also confirms that the LWP-emulation mode aligns with the results from the LWP-TRENDS R script.

## Data
A synthetic dataset of 15 years of monthly samples was generated. The data includes three components:
- A linear increasing trend (target annual slope: 0.50).
- A strong sinusoidal seasonal pattern with a 12-month period.
- Random noise.

The plot generated by the `MannKS` analysis is shown below. It clearly shows the seasonal cycle and the underlying upward trend.

![Seasonal Trend Plot](seasonal_trend_plot.png)

```python
import pandas as pd
import numpy as np
import MannKS as mk

# Generate Data
n_years = 15
n = n_years * 12
t = pd.to_datetime(pd.date_range(start='2000-01-01', periods=n, freq='MS'))
slope = 0.0417 # Per month
intercept = 10
trend = slope * np.arange(n) + intercept
seasonal = 2 * np.sin(2 * np.pi * np.arange(n) / 12)
noise = np.random.normal(0, 0.5, n)
x = trend + seasonal + noise

# Run MannKS seasonal test
mk_results = mk.seasonal_trend_test(x, t, period=12, slope_scaling='year')
print("Annual Sen's Slope:", mk_results.slope)
print("p-value:", mk_results.p)
```

## Results Comparison

| Metric              | MannKS (Standard) | MannKS (LWP Mode) | LWP-TRENDS R Script |
|---------------------|-----------------------|-----------------------|---------------------|
| p-value             | 0.000000   | 0.000000        | 0.000000     |
| Sen's Slope (annual)| 0.514643 | 0.514643    | 0.514643       |
| Lower CI (90%)      | 0.501061 | 0.501080 | 0.501080    |
| Upper CI (90%)      | 0.526607 | 0.526600 | 0.526600    |

## Analysis
All methods correctly identify a highly significant increasing trend (p-value â‰ˆ 0).

The **MannKS (LWP Mode)**, which uses LWP-style temporal aggregation (`agg_method='lwp'`) and confidence interval calculation (`ci_method='lwp'`), produces results that are nearly identical to the **LWP-TRENDS R Script**. The minor differences are likely due to subtle variations in floating-point precision and the handling of time calculations (e.g., Python's use of Unix timestamps vs. R's date objects).

The **MannKS (Standard)** mode also produces a very similar result, which is expected for this clean, uncensored dataset where the differences between the statistical methods are minimal. This validation confirms the seasonal analysis functionality is working correctly and that LWP-emulation is effective.